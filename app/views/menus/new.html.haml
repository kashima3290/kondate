%div
  = render "shared/header"
  = form_with model: @menu do |f|
    .ui.grid.container{style: "padding-top: 7%;"}
      %h1 写真
      = f.fields_for :images do |i|
        .doubling.four.column.row
          .column
            .ui.card
              .image
                = image_tag 'noimage.png', class: "change-image", id: "img-preview1"
              .contents
                = i.label :image, '画像を追加', class: 'ui bottom attached button', for: 'preview1'
                = i.file_field :image, type: 'file', class: 'change-file', id: 'preview1',style: "display:none;", onchange: "imgPreView(event, 'preview1')"
          .column
            .ui.card
              .image
                = image_tag 'noimage.png', class: "change-image", id: "img-preview2"
              .contents
                = i.label :image, '画像を追加', class: 'ui bottom attached button', for: 'preview2'
                = i.file_field :image, type: 'file', class: 'change-file', style: "display:none;", id: "preview2", onchange: "imgPreView(event, 'preview2')"
          .column
            .ui.card
              .image
                = image_tag 'noimage.png', class: "change-image", id: "img-preview3"
              .contents
                = i.label :image, '画像を追加', class: 'ui bottom attached button', for: 'preview3'
                = i.file_field :image, type: 'file', class: 'change-file', style: "display:none;", id: "preview3", onchange: "imgPreView(event, 'preview3')"

          .column
            .ui.card
              .image
                = image_tag 'noimage.png', class: "change-image", id: "img-preview4"
              .contents
                .ui.bottom.attached.buttons
                  = i.label :image, '変更', class: 'ui green button'
                  = i.file_field :image, type: 'file', class: 'change-file', style: "display:none;", onchange: "imgPreView(event, 'preview4')"
                  .or
                  %button.ui.red.button.delete-preview  削除
:javascript
  function imgPreView(event, targetId) {
    let file = event.target.files[0];
    let reader = new FileReader();
    let preview = document.getElementById(targetId);
    let previewImage = document.getElementById("img-"+targetId);
    // src入れ替え
    reader.onload = function(event) {
      previewImage.setAttribute("src", reader.result);
      previewImage.setAttribute("id", "img-"+targetId);
    };
    reader.readAsDataURL(file);
    // ボタン入れ替え
  }

  function imgDelete(event, targetId){
  }